replicaCount: 3

image:
  repository: rancher/k3s
  tag: v1.34.3-k3s1
  pullPolicy: IfNotPresent

token:
  # IMPORTANT: replace with something real (or template a Secret)
  value: "super-secret-k3s-token"
  # Use an existing Secret instead of creating one from token.value
  # existingSecret:
  #   name: ""
  #   key: "token"

# ------------------------------------------------------------
# API Service (k3s Kubernetes API on :7443)
# ------------------------------------------------------------
service:
  api:
    enabled: true
    type: ClusterIP  # ClusterIP | LoadBalancer | NodePort
    port: 7443

    # If type=LoadBalancer, these can be used
    annotations: {}
    loadBalancerSourceRanges: []  # e.g. ["1.2.3.4/32"]
    externalTrafficPolicy: Cluster

# ------------------------------------------------------------
# Persistence (optional for external datastore deployments)
# ------------------------------------------------------------
persistence:
  enabled: true
  size: 20Gi
  storageClassName: "" # "" uses default StorageClass
  accessModes:
    - ReadWriteOnce

# ------------------------------------------------------------
# Scheduling / security
# ------------------------------------------------------------
securityContext:
  privileged: true

hostNetwork:
  enabled: true

antiAffinity:
  enabled: true

resources:
  requests:
    cpu: 250m
    memory: 512Mi
  limits:
    cpu: 1000m
    memory: 1Gi
nodeSelector: {}
tolerations: []
affinity: {}

# ------------------------------------------------------------
# Health checks
# ------------------------------------------------------------
healthChecks:
  enabled: true

  liveness:
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 6
    successThreshold: 1

  readiness:
    initialDelaySeconds: 10
    periodSeconds: 5
    timeoutSeconds: 5
    failureThreshold: 6
    successThreshold: 1

  startup:
    enabled: true
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 30

# ------------------------------------------------------------
# k3s server options
# ------------------------------------------------------------
k3s:
  # HTTPS port for the Kubernetes API server (must match services and join URL)
  apiPort: 6443
  # Load balancer server port for k3s agents
  lbServerPort: 6444
  # Enable verbose k3s logging (K3S_DEBUG)
  debug: false
  # Extra args passed to k3s server
  extraArgs:
    - "--write-kubeconfig-mode=644"
    # You can disable built-ins if you want:
    # - "--disable=traefik"
    # - "--disable=servicelb"
    # - "--disable=metrics-server"
  # External datastore configuration (required for this chart)
  datastore:
    endpoint: ""
    cafile: ""
    certfile: ""
    keyfile: ""

  # TLS SANs for API server certificate.
  # If you expose via LoadBalancer, add the LB DNS name (or your custom DNS)
  tlsSANs: []
  # Example:
  # tlsSANs:
  #   - "k3s-api.example.com"
  #   - "a1b2c3d4e5f6.elb.amazonaws.com"
